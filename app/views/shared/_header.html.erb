<header class="py-1 px-2 md:py-2 md:px-6 lg:py-2 lg:px-10 border-b border-primary flex items-center justify-between">
  <div class="flex items-center">
    <%= image_tag "himawari.svg", alt: "ロゴ", class: "h-12 w-12 sm:h-14 w-14 lg:h-16 w-16" %>
    <%= link_to t('.site_name'), home_path, class: "font-mplus font-bold text-primary md:ml-2 text-md sm:text-lg lg:text-xl" %>
  </div>

  <div class="flex items-center space-x-4" >
    <div data-controller="theme"
        data-theme-light-value="hidamarinikki"
        data-theme-dark-value="sunset">

      <label class="flex cursor-pointer gap-2">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="12" cy="12" r="5" />
          <path d="M12 1v2M12 21v2M4.2 4.2l1.4 1.4M18.4 18.4l1.4 1.4M1 12h2M21 12h2M4.2 19.8l1.4-1.4M18.4 5.6l1.4-1.4" />
        </svg>

        <input type="checkbox" 
              value="sunset" 
              class="toggle theme-controller" 
              data-action="change->theme#toggle"
              data-theme-target="toggle" />

        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
        </svg>
      </label>
    </div>

    <div class="drawer drawer-end">
      <input id="my-drawer-4" type="checkbox" class="drawer-toggle" />
      <div class="drawer-content">
        <label for="my-drawer-4" 
              class="btn btn-circle btn-primary btn-ghost"
              onclick="spinOnce(this)">
          <span class="setting-icon material-symbols-outlined">
            settings
          </span>
        </label>
      </div>
      <div class="drawer-side z-50">
        <label for="my-drawer-4" aria-label="close sidebar" class="drawer-overlay"></label>
        <ul class="menu p-4 w-80 min-h-full bg-base-200 text-base-content">
          <li><%= link_to "ひだまり日記の書き方ガイド", diary_writing_tips_path %></li>
          <li><a>利用規約（準備中）</a></li>
          <li><%= link_to "プライバシーポリシー", privacy_policy_path %></li>
          <li><a>お問い合わせ（準備中）</a></li>
        </ul>
      </div>
    </div>

    <script>
      function spinOnce(el) {
        const icon = el.querySelector(".setting-icon");
        icon.classList.add("spin-once");
        icon.addEventListener("animationend", () => {
          icon.classList.remove("spin-once");
        }, { once: true });
      }
    </script>

  </div>
</header>